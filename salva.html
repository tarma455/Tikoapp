<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TIKO - Salud Animal</title>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    
    <style>
        :root { --p: #1e3a8a; --s: #2563eb; --bg: #f8fafc; }
        body { font-family: 'Segoe UI', Arial, sans-serif; background: var(--bg); margin: 0; padding: 0; color: #333; }
        .screen { display: none; padding: 20px; max-width: 450px; margin: auto; animation: fadeIn 0.3s; }
        .active { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .card { background: white; padding: 20px; border-radius: 16px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); margin-bottom: 20px; }
        h2 { color: var(--p); text-align: center; }
        input { width: 100%; padding: 12px; margin: 8px 0; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; font-size: 16px; }
        button { width: 100%; padding: 14px; border: none; border-radius: 10px; background: var(--p); color: white; font-weight: bold; cursor: pointer; margin-top: 10px; font-size: 16px; }
        .btn-sec { background: var(--s); }
        .btn-back { background: #94a3b8; margin-top: 15px; }
        .item { padding: 12px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; font-size: 14px; background: #fff; }
        
        /* Estilos espec√≠ficos para la Cartilla y PDF */
        #pdf-area { background: white; padding: 15px; border-radius: 10px; }
        .pdf-header { text-align: center; border-bottom: 3px solid var(--p); padding-bottom: 10px; margin-bottom: 15px; }
        .pdf-section { background: #f1f5f9; padding: 8px; font-weight: bold; color: var(--p); margin-top: 15px; border-radius: 4px; }
        
        /* Ocultar elementos en modo QR */
        .solo-lectura .btn-back, .solo-lectura #btn-descarga, .solo-lectura #nav-main { display: none !important; }
    </style>
</head>
<body id="main-body">

    <div id="scr-login" class="screen active">
        <h2>üêæ TIKO LOGIN</h2>
        <div class="card">
            <input type="text" id="login-user" placeholder="Nombre de Usuario">
            <button onclick="login()">INGRESAR</button>
        </div>
    </div>

    <div id="scr-home" class="screen">
        <h2>Panel Principal</h2>
        <div id="nav-main" style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
            <button onclick="show('scr-mascota')">üê∂ MASCOTA</button>
            <button onclick="show('scr-vacunas')">üíâ VACUNAS</button>
            <button onclick="show('scr-historial')">ü©∫ HISTORIAL</button>
            <button class="btn-sec" onclick="renderCartilla()">üìã CARTILLA</button>
        </div>
        <button class="btn-back" onclick="location.reload()">CERRAR SESI√ìN</button>
    </div>

    <div id="scr-mascota" class="screen">
        <h2>Datos Mascota</h2>
        <div class="card">
            <input type="text" id="m-nom" placeholder="Nombre de mascota">
            <input type="text" id="m-esp" placeholder="Especie / Raza">
            <input type="number" id="m-edad" placeholder="Edad">
            <button onclick="saveMascota()">GUARDAR DATOS</button>
        </div>
        <button class="btn-back" onclick="show('scr-home')">VOLVER</button>
    </div>

    <div id="scr-vacunas" class="screen">
        <h2>Vacunas</h2>
        <div class="card">
            <input type="text" id="v-nom" placeholder="Nombre de vacuna">
            <input type="date" id="v-fec">
            <button onclick="addVacuna()">REGISTRAR VACUNA</button>
            <div id="list-v" style="margin-top:15px"></div>
        </div>
        <button class="btn-back" onclick="show('scr-home')">VOLVER</button>
    </div>

    <div id="scr-historial" class="screen">
        <h2>Enfermedades</h2>
        <div class="card">
            <input type="text" id="h-enf" placeholder="Diagn√≥stico">
            <input type="date" id="h-fec">
            <button onclick="addHistorial()">A√ëADIR REGISTRO</button>
            <div id="list-h" style="margin-top:15px"></div>
        </div>
        <button class="btn-back" onclick="show('scr-home')">VOLVER</button>
    </div>

    <div id="scr-cartilla" class="screen">
        <div id="pdf-area">
            <div class="pdf-header">
                <h1 style="margin:0; font-size: 22px; color: #1e3a8a;">CARTILLA DE SALUD TIKO</h1>
            </div>
            <div id="c-mascota" style="margin-bottom: 15px; line-height: 1.6;"></div>
            
            <div class="pdf-section">üíâ ESQUEMA DE VACUNACI√ìN</div>
            <div id="c-vacunas"></div>
